

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>selene_sdk &mdash; Selene 0.5.0 documentation</title>
  

  
  
    <link rel="shortcut icon" href="_static/favicon.ico"/>
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Raleway" type="text/css" />
  <link rel="stylesheet" href="_static/css/selene_docs_theme.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="selene_sdk.interpret" href="interpret.html" />
    <link rel="prev" title="FAQ and additional resources" href="overview/faq.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> Selene
          

          
            
            <img src="_static/selene_logo.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                0.5.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          

            
            
              
            
            
              <p class="caption"><span class="caption-text">Overview</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="overview/overview.html">Functional overview of the SDK</a><ul>
<li class="toctree-l2"><a class="reference internal" href="overview/overview.html#sampling">Sampling</a><ul>
<li class="toctree-l3"><a class="reference internal" href="overview/overview.html#sequences-submodule-api"><em>sequences</em> submodule (API)</a></li>
<li class="toctree-l3"><a class="reference internal" href="overview/overview.html#targets-submodule-api"><em>targets</em> submodule (API)</a></li>
<li class="toctree-l3"><a class="reference internal" href="overview/overview.html#samplers-submodule-api"><em>samplers</em> submodule (API)</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="overview/overview.html#training-a-model-api">Training a model (API)</a></li>
<li class="toctree-l2"><a class="reference internal" href="overview/overview.html#evaluating-a-model-api">Evaluating a model (API)</a></li>
<li class="toctree-l2"><a class="reference internal" href="overview/overview.html#using-a-model-to-make-predictions-api">Using a model to make predictions (API)</a></li>
<li class="toctree-l2"><a class="reference internal" href="overview/overview.html#visualizing-model-predictions-api">Visualizing model predictions (API)</a></li>
<li class="toctree-l2"><a class="reference internal" href="overview/overview.html#the-utilities-submodule-api">The utilities submodule (API)</a></li>
<li class="toctree-l2"><a class="reference internal" href="overview/overview.html#help">Help</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="overview/installation.html">Installation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="overview/installation.html#installing-with-anaconda">Installing with Anaconda</a></li>
<li class="toctree-l2"><a class="reference internal" href="overview/installation.html#installing-selene-with-pip">Installing selene with pip</a></li>
<li class="toctree-l2"><a class="reference internal" href="overview/installation.html#installing-from-source">Installing from source</a></li>
<li class="toctree-l2"><a class="reference internal" href="overview/installation.html#additional-dependency-for-running-the-cli-versions-0-4-8-and-below">Additional dependency for running the CLI (versions 0.4.8 and below)</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="overview/cli.html">Selene CLI operations and outputs</a><ul>
<li class="toctree-l2"><a class="reference internal" href="overview/cli.html#overview">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="overview/cli.html#operations">Operations</a></li>
<li class="toctree-l2"><a class="reference internal" href="overview/cli.html#general-configurations">General configurations</a></li>
<li class="toctree-l2"><a class="reference internal" href="overview/cli.html#model-architecture">Model architecture</a><ul>
<li class="toctree-l3"><a class="reference internal" href="overview/cli.html#expected-input-class-and-methods">Expected input class and methods</a></li>
<li class="toctree-l3"><a class="reference internal" href="overview/cli.html#model-architecture-configuration">Model architecture configuration</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="overview/cli.html#a-note-for-the-following-sections">A note for the following sections</a></li>
<li class="toctree-l2"><a class="reference internal" href="overview/cli.html#train">Train</a><ul>
<li class="toctree-l3"><a class="reference internal" href="overview/cli.html#required-parameters">Required parameters</a></li>
<li class="toctree-l3"><a class="reference internal" href="overview/cli.html#optional-parameters">Optional parameters</a></li>
<li class="toctree-l3"><a class="reference internal" href="overview/cli.html#additional-notes">Additional notes</a></li>
<li class="toctree-l3"><a class="reference internal" href="overview/cli.html#expected-outputs-for-training">Expected outputs for training</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="overview/cli.html#evaluate">Evaluate</a><ul>
<li class="toctree-l3"><a class="reference internal" href="overview/cli.html#id1">Required parameters</a></li>
<li class="toctree-l3"><a class="reference internal" href="overview/cli.html#id2">Optional parameters</a></li>
<li class="toctree-l3"><a class="reference internal" href="overview/cli.html#id3">Additional notes</a></li>
<li class="toctree-l3"><a class="reference internal" href="overview/cli.html#expected-outputs-for-evaluation">Expected outputs for evaluation</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="overview/cli.html#analyze-sequences">Analyze sequences</a><ul>
<li class="toctree-l3"><a class="reference internal" href="overview/cli.html#id4">Required parameters</a></li>
<li class="toctree-l3"><a class="reference internal" href="overview/cli.html#id5">Optional parameters</a></li>
<li class="toctree-l3"><a class="reference internal" href="overview/cli.html#prediction-on-sequences">Prediction on sequences</a><ul>
<li class="toctree-l4"><a class="reference internal" href="overview/cli.html#parameters">Parameters</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="overview/cli.html#id6">Variant effect prediction</a><ul>
<li class="toctree-l4"><a class="reference internal" href="overview/cli.html#id7">Parameters</a></li>
<li class="toctree-l4"><a class="reference internal" href="overview/cli.html#additional-note">Additional note</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="overview/cli.html#id8"><em>In silico</em> mutagenesis</a><ul>
<li class="toctree-l4"><a class="reference internal" href="overview/cli.html#parameters-for-a-single-sequence-input">Parameters for a single sequence input</a></li>
<li class="toctree-l4"><a class="reference internal" href="overview/cli.html#parameters-for-fasta-file-input">Parameters for FASTA file input:</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="overview/cli.html#sampler-configurations">Sampler configurations</a><ul>
<li class="toctree-l3"><a class="reference internal" href="overview/cli.html#samplers-used-for-training-and-evaluation-optionally">Samplers used for training (and evaluation, optionally)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="overview/cli.html#random-positions-sampler">Random positions sampler</a></li>
<li class="toctree-l4"><a class="reference internal" href="overview/cli.html#intervals-sampler">Intervals sampler</a></li>
<li class="toctree-l4"><a class="reference internal" href="overview/cli.html#multiple-file-sampler">Multiple-file sampler</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="overview/cli.html#important-note">Important note</a></li>
<li class="toctree-l3"><a class="reference internal" href="overview/cli.html#samplers-used-for-evaluation">Samplers used for evaluation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="overview/cli.html#bed-file-sampler">BED file sampler</a></li>
<li class="toctree-l4"><a class="reference internal" href="overview/cli.html#matrix-file-sampler">Matrix file sampler</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="overview/cli.html#examples-of-full-configuration-files">Examples of full configuration files</a><ul>
<li class="toctree-l3"><a class="reference internal" href="overview/cli.html#training-using-intervals-sampler">Training (using intervals sampler)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="overview/cli.html#some-notes">Some notes</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="overview/cli.html#evaluate-using-matrix-file-sampler">Evaluate (using matrix file sampler)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="overview/cli.html#id15">Some notes</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="overview/cli.html#analyze-sequences-variant-effect-prediction">Analyze sequences (variant effect prediction)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="overview/cli.html#id16">Some notes</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="overview/tutorials.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="overview/faq.html">FAQ and additional resources</a><ul>
<li class="toctree-l2"><a class="reference internal" href="overview/faq.html#extending-selene">Extending Selene</a></li>
<li class="toctree-l2"><a class="reference internal" href="overview/faq.html#exporting-a-selene-trained-model-to-kipoi">Exporting a Selene-trained model to Kipoi</a></li>
<li class="toctree-l2"><a class="reference internal" href="overview/faq.html#hyperparameter-optimization">Hyperparameter optimization</a></li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">Packages</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">selene_sdk</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#trainmodel">TrainModel</a></li>
<li class="toctree-l2"><a class="reference internal" href="#evaluatemodel">EvaluateModel</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="interpret.html">selene_sdk.interpret</a><ul>
<li class="toctree-l2"><a class="reference internal" href="interpret.html#sequence-logo">sequence_logo</a></li>
<li class="toctree-l2"><a class="reference internal" href="interpret.html#heatmap">heatmap</a></li>
<li class="toctree-l2"><a class="reference internal" href="interpret.html#ismresult">ISMResult</a></li>
<li class="toctree-l2"><a class="reference internal" href="interpret.html#rescale-score-matrix">rescale_score_matrix</a></li>
<li class="toctree-l2"><a class="reference internal" href="interpret.html#load-variant-abs-diff-scores">load_variant_abs_diff_scores</a></li>
<li class="toctree-l2"><a class="reference internal" href="interpret.html#variant-diffs-scatter-plot">variant_diffs_scatter_plot</a></li>
<li class="toctree-l2"><a class="reference internal" href="interpret.html#ordered-variants-and-indices">ordered_variants_and_indices</a></li>
<li class="toctree-l2"><a class="reference internal" href="interpret.html#sort-standard-chrs">sort_standard_chrs</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="predict.html">selene_sdk.predict</a><ul>
<li class="toctree-l2"><a class="reference internal" href="predict.html#analyzesequences">AnalyzeSequences</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="samplers.html">selene_sdk.samplers</a><ul>
<li class="toctree-l2"><a class="reference internal" href="samplers.html#sampler">Sampler</a></li>
<li class="toctree-l2"><a class="reference internal" href="samplers.html#onlinesampler">OnlineSampler</a></li>
<li class="toctree-l2"><a class="reference internal" href="samplers.html#intervalssampler">IntervalsSampler</a></li>
<li class="toctree-l2"><a class="reference internal" href="samplers.html#randompositionssampler">RandomPositionsSampler</a></li>
<li class="toctree-l2"><a class="reference internal" href="samplers.html#multifilesampler">MultiFileSampler</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="samplers.file_samplers.html">selene_sdk.samplers.file_samplers</a><ul>
<li class="toctree-l2"><a class="reference internal" href="samplers.file_samplers.html#bedfilesampler">BedFileSampler</a></li>
<li class="toctree-l2"><a class="reference internal" href="samplers.file_samplers.html#matfilesampler">MatFileSampler</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="sequences.html">selene_sdk.sequences</a><ul>
<li class="toctree-l2"><a class="reference internal" href="sequences.html#sequence">Sequence</a></li>
<li class="toctree-l2"><a class="reference internal" href="sequences.html#genome">Genome</a></li>
<li class="toctree-l2"><a class="reference internal" href="sequences.html#proteome">Proteome</a></li>
<li class="toctree-l2"><a class="reference internal" href="sequences.html#sequence-to-encoding">sequence_to_encoding</a></li>
<li class="toctree-l2"><a class="reference internal" href="sequences.html#encoding-to-sequence">encoding_to_sequence</a></li>
<li class="toctree-l2"><a class="reference internal" href="sequences.html#get-reverse-encoding">get_reverse_encoding</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="targets.html">selene_sdk.targets</a><ul>
<li class="toctree-l2"><a class="reference internal" href="targets.html#target">Target</a></li>
<li class="toctree-l2"><a class="reference internal" href="targets.html#genomicfeatures">GenomicFeatures</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="utils.html">selene_sdk.utils</a><ul>
<li class="toctree-l2"><a class="reference internal" href="utils.html#nonstrandspecific">NonStrandSpecific</a></li>
<li class="toctree-l2"><a class="reference internal" href="utils.html#performancemetrics">PerformanceMetrics</a></li>
<li class="toctree-l2"><a class="reference internal" href="utils.html#initialize-logger">initialize_logger</a></li>
<li class="toctree-l2"><a class="reference internal" href="utils.html#load-features-list">load_features_list</a></li>
<li class="toctree-l2"><a class="reference internal" href="utils.html#load-model-from-state-dict">load_model_from_state_dict</a></li>
<li class="toctree-l2"><a class="reference internal" href="utils.html#get-indices-and-probabilities">get_indices_and_probabilities</a></li>
<li class="toctree-l2"><a class="reference internal" href="utils.html#load-path-for-config-yml">load_path (for config.yml)</a></li>
<li class="toctree-l2"><a class="reference internal" href="utils.html#instantiate-configuration-object">instantiate (configuration object)</a></li>
<li class="toctree-l2"><a class="reference internal" href="utils.html#initialize-model">initialize_model</a></li>
<li class="toctree-l2"><a class="reference internal" href="utils.html#parse-configs-and-run">parse_configs_and_run</a></li>
<li class="toctree-l2"><a class="reference internal" href="utils.html#execute-run-selene-operations">execute (run Selene operations)</a></li>
</ul>
</li>
</ul>

            
          

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Selene</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>selene_sdk</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/selene.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <section id="module-selene_sdk">
<span id="selene-sdk"></span><h1>selene_sdk<a class="headerlink" href="#module-selene_sdk" title="Permalink to this headline">¶</a></h1>
<p>This is the main module for Selene.</p>
<section id="trainmodel">
<h2>TrainModel<a class="headerlink" href="#trainmodel" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="selene_sdk.TrainModel">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">selene_sdk.</span></span><span class="sig-name descname"><span class="pre">TrainModel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">model</span></em>, <em class="sig-param"><span class="pre">data_sampler</span></em>, <em class="sig-param"><span class="pre">loss_criterion</span></em>, <em class="sig-param"><span class="pre">optimizer_class</span></em>, <em class="sig-param"><span class="pre">optimizer_kwargs</span></em>, <em class="sig-param"><span class="pre">batch_size</span></em>, <em class="sig-param"><span class="pre">max_steps</span></em>, <em class="sig-param"><span class="pre">report_stats_every_n_steps</span></em>, <em class="sig-param"><span class="pre">output_dir</span></em>, <em class="sig-param"><span class="pre">save_checkpoint_every_n_steps=1000</span></em>, <em class="sig-param"><span class="pre">save_new_checkpoints_after_n_steps=None</span></em>, <em class="sig-param"><span class="pre">report_gt_feature_n_positives=10</span></em>, <em class="sig-param"><span class="pre">n_validation_samples=None</span></em>, <em class="sig-param"><span class="pre">n_test_samples=None</span></em>, <em class="sig-param"><span class="pre">cpu_n_threads=1</span></em>, <em class="sig-param"><span class="pre">use_cuda=False</span></em>, <em class="sig-param"><span class="pre">data_parallel=False</span></em>, <em class="sig-param"><span class="pre">logging_verbosity=2</span></em>, <em class="sig-param"><span class="pre">checkpoint_resume=None</span></em>, <em class="sig-param"><span class="pre">metrics={'average_precision':</span> <span class="pre">&lt;function</span> <span class="pre">average_precision_score&gt;</span></em>, <em class="sig-param"><span class="pre">'roc_auc':</span> <span class="pre">&lt;function</span> <span class="pre">roc_auc_score&gt;}</span></em>, <em class="sig-param"><span class="pre">use_scheduler=True</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/selene_sdk/train_model.html#TrainModel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#selene_sdk.TrainModel" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>This class ties together the various objects and methods needed to
train and validate a model.</p>
<p>TrainModel saves a checkpoint model (overwriting it after
<cite>save_checkpoint_every_n_steps</cite>) as well as a best-performing model
(overwriting it after <cite>report_stats_every_n_steps</cite> if the latest
validation performance is better than the previous best-performing
model) to <cite>output_dir</cite>.</p>
<p>TrainModel also outputs 2 files that can be used to monitor training
as Selene runs: <cite>selene_sdk.train_model.train.txt</cite> (training loss) and
<cite>selene_sdk.train_model.validation.txt</cite> (validation loss &amp; average
ROC AUC). The columns in these files can be used to quickly visualize
training history (e.g. you can use <cite>matplotlib</cite>, <cite>plt.plot(auc_list)</cite>)
and see, for example, whether the model is still improving, if there are
signs of overfitting, etc.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul>
<li><p><strong>model</strong> (<em>torch.nn.Module</em>) – The model to train.</p></li>
<li><p><strong>data_sampler</strong> (<em>selene_sdk.samplers.Sampler</em>) – The example generator.</p></li>
<li><p><strong>loss_criterion</strong> (<em>torch.nn._Loss</em>) – The loss function to optimize.</p></li>
<li><p><strong>optimizer_class</strong> (<em>torch.optim.Optimizer</em>) – The optimizer to minimize loss with.</p></li>
<li><p><strong>optimizer_kwargs</strong> (<em>dict</em>) – The dictionary of keyword arguments to pass to the optimizer’s
constructor.</p></li>
<li><p><strong>batch_size</strong> (<em>int</em>) – Specify the batch size to process examples. Should be a power of 2.</p></li>
<li><p><strong>max_steps</strong> (<em>int</em>) – The maximum number of mini-batches to iterate over.</p></li>
<li><p><strong>report_stats_every_n_steps</strong> (<em>int</em>) – The frequency with which to report summary statistics. You can
set this value to be equivalent to a training epoch
(<cite>n_steps * batch_size</cite>) being the total number of samples
seen by the model so far. Selene evaluates the model on the validation
dataset every <cite>report_stats_every_n_steps</cite> and, if the model obtains
the best performance so far (based on the user-specified loss function),
Selene saves the model state to a file called <cite>best_model.pth.tar</cite> in
<cite>output_dir</cite>.</p></li>
<li><p><strong>output_dir</strong> (<em>str</em>) – The output directory to save model checkpoints and logs in.</p></li>
<li><p><strong>save_checkpoint_every_n_steps</strong> (<em>int or None, optional</em>) – Default is 1000. If None, set to the same value as
<cite>report_stats_every_n_steps</cite></p></li>
<li><p><strong>save_new_checkpoints_after_n_steps</strong> (<em>int or None, optional</em>) – Default is None. The number of steps after which Selene will
continually save new checkpoint model weights files
(<cite>checkpoint-&lt;TIMESTAMP&gt;.pth.tar</cite>) every
<cite>save_checkpoint_every_n_steps</cite>. Before this point,
the file <cite>checkpoint.pth.tar</cite> is overwritten every
<cite>save_checkpoint_every_n_steps</cite> to limit the memory requirements.</p></li>
<li><p><strong>n_validation_samples</strong> (<em>int or None, optional</em>) – Default is <cite>None</cite>. Specify the number of validation samples in the
validation set. If <cite>n_validation_samples</cite> is <cite>None</cite> and the data sampler
used is the <cite>selene_sdk.samplers.IntervalsSampler</cite> or
<cite>selene_sdk.samplers.RandomSampler</cite>, we will retrieve 32000
validation samples. If <cite>None</cite> and using
<cite>selene_sdk.samplers.MultiSampler</cite>, we will use all
available validation samples from the appropriate data file.</p></li>
<li><p><strong>n_test_samples</strong> (<em>int or None, optional</em>) – Default is <cite>None</cite>. Specify the number of test samples in the test set.
If <cite>n_test_samples</cite> is <cite>None</cite> and</p>
<blockquote>
<div><ul class="simple">
<li><p>the sampler you specified has no test partition, you should not
specify <cite>evaluate</cite> as one of the operations in the <cite>ops</cite> list.
That is, Selene will not automatically evaluate your trained
model on a test dataset, because the sampler you are using does
not have any test data.</p></li>
<li><p>the sampler you use is of type <cite>selene_sdk.samplers.OnlineSampler</cite>
(and the test partition exists), we will retrieve 640000 test
samples.</p></li>
<li><p>the sampler you use is of type
<cite>selene_sdk.samplers.MultiSampler</cite> (and the test partition
exists), we will use all the test samples available in the
appropriate data file.</p></li>
</ul>
</div></blockquote>
</li>
<li><p><strong>cpu_n_threads</strong> (<em>int, optional</em>) – Default is 1. Sets the number of OpenMP threads used for parallelizing
CPU operations.</p></li>
<li><p><strong>use_cuda</strong> (<em>bool, optional</em>) – Default is <cite>False</cite>. Specify whether a CUDA-enabled GPU is available
for torch to use during training.</p></li>
<li><p><strong>data_parallel</strong> (<em>bool, optional</em>) – Default is <cite>False</cite>. Specify whether multiple GPUs are available
for torch to use during training.</p></li>
<li><p><strong>logging_verbosity</strong> (<em>{0, 1, 2}, optional</em>) –</p>
<p>Default is 2. Set the logging verbosity level.</p>
<blockquote>
<div><ul class="simple">
<li><p>0 - Only warnings will be logged.</p></li>
<li><p>1 - Information and warnings will be logged.</p></li>
<li><p>2 - Debug messages, information, and warnings will all be                  logged.</p></li>
</ul>
</div></blockquote>
</li>
<li><p><strong>checkpoint_resume</strong> (<em>str or None, optional</em>) – Default is <cite>None</cite>. If <cite>checkpoint_resume</cite> is not None, it should be the
path to a model file generated by <cite>torch.save</cite> that can now be read
using <cite>torch.load</cite>.</p></li>
<li><p><strong>use_scheduler</strong> (<em>bool, optional</em>) – Default is <cite>True</cite>. If <cite>True</cite>, learning rate scheduler is used to
reduce learning rate on plateau. PyTorch ReduceLROnPlateau scheduler
with patience=16 and factor=0.8 is used.</p></li>
</ul>
</dd>
<dt class="field-even">Variables</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>~TrainModel.model</strong> (<a class="reference external" href="https://pytorch.org/docs/master/generated/torch.nn.Module.html#torch.nn.Module" title="(in PyTorch vmaster (1.10.0a0+git89e6f30 ))"><em>torch.nn.Module</em></a>) – The model to train.</p></li>
<li><p><strong>~TrainModel.sampler</strong> (<a class="reference internal" href="samplers.html#selene_sdk.samplers.Sampler" title="selene_sdk.samplers.Sampler"><em>selene_sdk.samplers.Sampler</em></a>) – The example generator.</p></li>
<li><p><strong>~TrainModel.criterion</strong> (<em>torch.nn._Loss</em>) – The loss function to optimize.</p></li>
<li><p><strong>~TrainModel.optimizer</strong> (<a class="reference external" href="https://pytorch.org/docs/master/optim.html#torch.optim.Optimizer" title="(in PyTorch vmaster (1.10.0a0+git89e6f30 ))"><em>torch.optim.Optimizer</em></a>) – The optimizer to minimize loss with.</p></li>
<li><p><strong>~TrainModel.batch_size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – The size of the mini-batch to use during training.</p></li>
<li><p><strong>~TrainModel.max_steps</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – The maximum number of mini-batches to iterate over.</p></li>
<li><p><strong>~TrainModel.nth_step_report_stats</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – The frequency with which to report summary statistics.</p></li>
<li><p><strong>~TrainModel.nth_step_save_checkpoint</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – The frequency with which to save a model checkpoint.</p></li>
<li><p><strong>~TrainModel.use_cuda</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a>) – If <cite>True</cite>, use a CUDA-enabled GPU. If <cite>False</cite>, use the CPU.</p></li>
<li><p><strong>~TrainModel.data_parallel</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a>) – Whether to use multiple GPUs or not.</p></li>
<li><p><strong>~TrainModel.output_dir</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) – The directory to save model checkpoints and logs.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="selene_sdk.TrainModel.create_test_set">
<span class="sig-name descname"><span class="pre">create_test_set</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/selene_sdk/train_model.html#TrainModel.create_test_set"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#selene_sdk.TrainModel.create_test_set" title="Permalink to this definition">¶</a></dt>
<dd><p>Loads the set of test samples.
We do not create the test set in the <cite>TrainModel</cite> object until
this method is called, so that we avoid having to load it into
memory until the model has been trained and is ready to be
evaluated.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="selene_sdk.TrainModel.evaluate">
<span class="sig-name descname"><span class="pre">evaluate</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/selene_sdk/train_model.html#TrainModel.evaluate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#selene_sdk.TrainModel.evaluate" title="Permalink to this definition">¶</a></dt>
<dd><p>Measures the model test performance.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>A dictionary, where keys are the names of the loss metrics,
and the values are the average value for that metric over
the test set.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.9)">dict</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="selene_sdk.TrainModel.train">
<span class="sig-name descname"><span class="pre">train</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/selene_sdk/train_model.html#TrainModel.train"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#selene_sdk.TrainModel.train" title="Permalink to this definition">¶</a></dt>
<dd><p>Trains the model on a batch of data.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The training loss.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)">float</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="selene_sdk.TrainModel.train_and_validate">
<span class="sig-name descname"><span class="pre">train_and_validate</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/selene_sdk/train_model.html#TrainModel.train_and_validate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#selene_sdk.TrainModel.train_and_validate" title="Permalink to this definition">¶</a></dt>
<dd><p>Trains the model and measures validation performance.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="selene_sdk.TrainModel.validate">
<span class="sig-name descname"><span class="pre">validate</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/selene_sdk/train_model.html#TrainModel.validate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#selene_sdk.TrainModel.validate" title="Permalink to this definition">¶</a></dt>
<dd><p>Measures model validation performance.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>A dictionary, where keys are the names of the loss metrics,
and the values are the average value for that metric over
the validation set.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.9)">dict</a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="evaluatemodel">
<h2>EvaluateModel<a class="headerlink" href="#evaluatemodel" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="selene_sdk.EvaluateModel">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">selene_sdk.</span></span><span class="sig-name descname"><span class="pre">EvaluateModel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">model</span></em>, <em class="sig-param"><span class="pre">criterion</span></em>, <em class="sig-param"><span class="pre">data_sampler</span></em>, <em class="sig-param"><span class="pre">features</span></em>, <em class="sig-param"><span class="pre">trained_model_path</span></em>, <em class="sig-param"><span class="pre">output_dir</span></em>, <em class="sig-param"><span class="pre">batch_size=64</span></em>, <em class="sig-param"><span class="pre">n_test_samples=None</span></em>, <em class="sig-param"><span class="pre">report_gt_feature_n_positives=10</span></em>, <em class="sig-param"><span class="pre">use_cuda=False</span></em>, <em class="sig-param"><span class="pre">data_parallel=False</span></em>, <em class="sig-param"><span class="pre">use_features_ord=None</span></em>, <em class="sig-param"><span class="pre">metrics={'average_precision':</span> <span class="pre">&lt;function</span> <span class="pre">average_precision_score&gt;</span></em>, <em class="sig-param"><span class="pre">'roc_auc':</span> <span class="pre">&lt;function</span> <span class="pre">roc_auc_score&gt;}</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/selene_sdk/evaluate_model.html#EvaluateModel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#selene_sdk.EvaluateModel" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Evaluate model on a test set of sequences with known targets.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<em>torch.nn.Module</em>) – The model architecture.</p></li>
<li><p><strong>criterion</strong> (<em>torch.nn._Loss</em>) – The loss function that was optimized during training.</p></li>
<li><p><strong>data_sampler</strong> (<em>selene_sdk.samplers.Sampler</em>) – Used to retrieve samples from the test set for evaluation.</p></li>
<li><p><strong>features</strong> (<em>list(str)</em>) – List of distinct features the model predicts.</p></li>
<li><p><strong>trained_model_path</strong> (<em>str</em>) – Path to the trained model file, saved using <cite>torch.save</cite>.</p></li>
<li><p><strong>output_dir</strong> (<em>str</em>) – The output directory in which to save model evaluation and logs.</p></li>
<li><p><strong>batch_size</strong> (<em>int, optional</em>) – Default is 64. Specify the batch size to process examples.
Should be a power of 2.</p></li>
<li><p><strong>n_test_samples</strong> (<em>int or None, optional</em>) – Default is <cite>None</cite>. Use <cite>n_test_samples</cite> if you want to limit the
number of samples on which you evaluate your model. If you are
using a sampler of type <cite>selene_sdk.samplers.OnlineSampler</cite>,
by default it will draw 640000 samples if <cite>n_test_samples</cite> is <cite>None</cite>.</p></li>
<li><p><strong>report_gt_feature_n_positives</strong> (<em>int, optional</em>) – Default is 10. In the final test set, each class/feature must have
more than <cite>report_gt_feature_n_positives</cite> positive samples in order to
be considered in the test performance computation. The output file that
states each class’ performance will report ‘NA’ for classes that do
not have enough positive samples.</p></li>
<li><p><strong>use_cuda</strong> (<em>bool, optional</em>) – Default is <cite>False</cite>. Specify whether a CUDA-enabled GPU is available
for torch to use during training.</p></li>
<li><p><strong>data_parallel</strong> (<em>bool, optional</em>) – Default is <cite>False</cite>. Specify whether multiple GPUs are available
for torch to use during training.</p></li>
<li><p><strong>use_features_ord</strong> (<em>list(str) or None, optional</em>) – Default is None. Specify an ordered list of features for which to
run the evaluation. The features in this list must be identical to or
a subset of <cite>features</cite>, and in the order you want the resulting
<cite>test_targets.npz</cite> and <cite>test_predictions.npz</cite> to be saved. If using
a FileSampler or H5DataLoader for the evaluation, you can pass in
a dataset with the targets matrix only containing these features, but
note that this subsetted targets matrix MUST be ordered the same
way as <cite>features</cite>, and the predictions and targets .npz output
will be reordered according to <cite>use_features_ord</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Variables</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>~EvaluateModel.model</strong> (<a class="reference external" href="https://pytorch.org/docs/master/generated/torch.nn.Module.html#torch.nn.Module" title="(in PyTorch vmaster (1.10.0a0+git89e6f30 ))"><em>torch.nn.Module</em></a>) – The trained model.</p></li>
<li><p><strong>~EvaluateModel.criterion</strong> (<em>torch.nn._Loss</em>) – The model was trained using this loss function.</p></li>
<li><p><strong>~EvaluateModel.sampler</strong> (<a class="reference internal" href="samplers.html#selene_sdk.samplers.Sampler" title="selene_sdk.samplers.Sampler"><em>selene_sdk.samplers.Sampler</em></a>) – The example generator.</p></li>
<li><p><strong>~EvaluateModel.features</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)"><em>list</em></a><em>(</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a><em>)</em>) – List of distinct features the model predicts.</p></li>
<li><p><strong>~EvaluateModel.batch_size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – The batch size to process examples. Should be a power of 2.</p></li>
<li><p><strong>~EvaluateModel.use_cuda</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a>) – If <cite>True</cite>, use a CUDA-enabled GPU. If <cite>False</cite>, use the CPU.</p></li>
<li><p><strong>~EvaluateModel.data_parallel</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a>) – Whether to use multiple GPUs or not.</p></li>
<li><p><strong>~EvaluateModel.metrics</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.9)"><em>dict</em></a>) – A dictionary that maps metric names (<cite>str</cite>) to metric functions.
By default, this contains <cite>“roc_auc”</cite>, which maps to
<cite>sklearn.metrics.roc_auc_score</cite>, and <cite>“average_precision”</cite>,
which maps to <cite>sklearn.metrics.average_precision_score</cite>.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="selene_sdk.EvaluateModel.evaluate">
<span class="sig-name descname"><span class="pre">evaluate</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/selene_sdk/evaluate_model.html#EvaluateModel.evaluate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#selene_sdk.EvaluateModel.evaluate" title="Permalink to this definition">¶</a></dt>
<dd><p>Passes all samples retrieved from the sampler to the model in
batches and returns the predictions. Also reports the model’s
performance on these examples.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>A dictionary, where keys are the features and the values are
each a dict of the performance metrics (currently ROC AUC and
AUPR) reported for each feature the model predicts.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.9)">dict</a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
</section>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="interpret.html" class="btn btn-neutral float-right" title="selene_sdk.interpret" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="overview/faq.html" class="btn btn-neutral float-left" title="FAQ and additional resources" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, Selene Contributors

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
  
 



</body>
</html>